<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">

    <title>Documaker for UMR &reg;</title>

    <link href="bootstrap-4.1.3-dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="bootstrap-datepicker-1.6.4-dist/css/bootstrap-datepicker.min.css" rel="stylesheet">
    <link href="css/index.css" rel="stylesheet">
  </head>

  <body>

    <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
      <h5 class="my-0 mr-md-auto font-weight-normal"><a href="#" class="navbar-left"><img src="img/UMR.png" alt="UMR Logo"></a></h5>
      <nav class="my-2 my-md-0 mr-md-3">
        <a class="p-2 text-dark" href="/DocumakerAdministrator" target="_blank">Administrator</a>
        <a class="p-2 text-dark" href="/DocumakerCorrespondence" target="_blank">Interactive</a>
        <a class="p-2 text-dark" href="/DocumakerDashboard" target="_blank">Dashboard</a>
      </nav>
    </div>

    <div class="pricing-header px-3 py-3 pt-md-5 pb-md-4 mx-auto text-center">
      <h1 class="display-4">Let's Build A Document...</h1>
      <p class="lead">Choose a primary document from the left, enter info in the center, and add supplementary forms on the right.</p>
    </div>
    <div class="container">
    	<form id="documentForm" action="formprocessor" name="documentForm" method="POST">
			<div class="row">
				<div class="col">
                                        <div class="form-group form-check">
                                                <input name="mainFormOption" type="radio" class="form-check-input" id="sbcCheck" aria-describedby="sbcCheckHelp" value="sbc">
                                                <label class="form-check-label" for="mainFormOption">SBC</label>
                                                <small id="sbcCheckHelp" class="form-text text-muted">Summary of Benefits Covered</small>
                                        </div>
                                        <div class="form-group form-check">
                                            <input name="mainFormOption" type="radio" class="form-check-input" id="DentalCheck" aria-describedby="DentalCheckHelp" value="dental">
                                            <label class="form-check-label" for="DentalCheck">Dental</label>
                                            <small id="DentalCheckHelp" class="form-text text-muted"></small>
                                        </div>
                                        <div class="form-group form-check">
                                            <input name="mainFormOption" type="radio" class="form-check-input" id="MedicalCheck" aria-describedby="MedicalCheckHelp" value="medical">
                                            <label class="form-check-label" for="MedicalCheck">Medical</label>
                                            <small id="MedicalCheckHelp" class="form-text text-muted"></small>
                                        </div>
                                        <hr/>
                                         <div class="form-group form-check">
                                            <input name="baseOrCustomOption" type="radio" class="form-check-input" id="baseOrCustomOption" aria-describedby="baseOrCustomOptionHelp" value="base">
                                            <label class="form-check-label" for="baseOrCustomOption">Base Document</label>
                                            <small id="baseOrCustomOptionHelp" class="form-text text-muted">Generate a base (non-editable) document.</small>
                                        </div>
                                        <div class="form-group form-check">
                                            <input name="baseOrCustomOption" type="radio" class="form-check-input" id="baseOrCustomOption" aria-describedby="baseOrCustomOptionHelp" checked="true" value="custom">
                                            <label class="form-check-label" for="baseOrCustomOption">Custom Document</label>
                                            <small id="baseOrCustomOptionHelp" class="form-text text-muted">Generate document for editing in Interactive.</small>
                                        </div>
                                </div>
				<div class="col">
                                        <div class="form-group">
                                            <label for="customerNumber">Customer Number</label>
                                            <input name="customerNumber" type="text" class="form-control" id="customerNumber" aria-describedby="customerNumberHelp" placeholder="Enter customer number">
                                            <small id="customerNumberHelp" class="form-text text-muted"></small>
                                        </div>
                                        <div class="form-group date">
                                            <label for="effectiveDate">Effective Date</label>
                                            <input name="effectiveDate" type="text" class="form-control" id="effectiveDate" aria-describedby="effectiveDateHelp" placeholder="Effective Date">
                                            <small id="effectiveDateHelp" class="form-text text-muted"></small>
                                        </div>
                                        <div class="form-group">
                                            <label for="benefitPlan">Benefit Plan</label>
                                            <input name="benefitPlan" type="text" class="form-control" disabled="true" id="benefitPlan" aria-describedby="benefitPlanHelp" placeholder="Benefit Plan number">
                                            <small id="benefitPlanHelp" class="form-text text-muted"></small>
                                        </div>
                                </div>
				<div class="col">
                                        <div class="form-group form-check">
                                            <input name="transplantScheduleCheck" type="checkbox" class="form-check-input" disabled="true" id="transplantScheduleCheck" aria-describedby="transplantScheduleHelp">
                                            <label class="form-check-label" for="transplantScheduleCheck">Transplant Schedule</label>
                                            <small id="transplantScheduleHelp" class="form-text text-muted"></small>
                                        </div>
                                        <div class="form-group form-check">
                                            <input name="pharmacyScheduleCheck" type="checkbox" class="form-check-input" id="pharmacyScheduleCheck" disabled="true" aria-describedby="pharmacyScheduleCheckHelp">
                                            <label class="form-check-label" for="pharmacyScheduleCheck">Pharmacy Schedule</label>
                                            <small id="pharmacyScheduleCheckHelp" class="form-text text-muted"></small>
                                        </div>
                                        <div class="form-group form-check">
                                            <input name="oopExpenseCheck" type="checkbox" class="form-check-input" disabled="true" id="oopExpenseCheck" aria-describedby="oopExpenseCheckHelp">
                                            <label class="form-check-label" for="oopExpenseCheck">Out-of-Pocket Expense</label>
                                            <small id="oopExpenseCheckHelp" class="form-text text-muted"></small>
                                        </div>
                                        <div class="form-group form-check">
                                            <input name="transplantProvisionCheck" type="checkbox" disabled="true" class="form-check-input" id="transplantProvisionCheck" aria-describedby="transplantProvisionCheckHelp">
                                            <label class="form-check-label" for="transplantProvisionCheck">Transplant Provision</label>
                                            <small id="transplantProvisionCheckHelp" class="form-text text-muted"></small>
                                        </div>
                                        <div class="form-group form-check">
                                            <input name="pharmacyProvisionCheck" type="checkbox" disabled="true" class="form-check-input" id="pharmacyProvisionCheck" aria-describedby="pharmacyProvisionCheckHelp">
                                            <label class="form-check-label" for="pharmacyProvisionCheck">Pharmacy Provision</label>
                                            <small id="pharmacyProvisionCheckHelp" class="form-text text-muted"></small>
                                        </div>
<hr/>
                                        <div class="form-group form-check">
                                            <input name="medSchedCheck" type="checkbox" class="form-check-input" id="medSchedCheck" aria-describedby="medSchedCheckHelp">
                                            <label class="form-check-label" for="medSchedCheck">Medical Schedule</label>
                                            <small id="medSchedCheckHelp" class="form-text text-muted"></small>
                                        </div>
                                        <div class="form-group form-check">
                                            <input name="medCovExclCheck" type="checkbox" class="form-check-input" id="medCovExclCheck" aria-describedby="medCovExclCheckHelp">
                                                <label class="form-check-label" for="medCovExclCheck">Medical Covered and Exclusions</label>
                                                <small id="medCovExclCheckHelp" class="form-text text-muted"></small>
                                        </div>
                                </div>

                        </div>
<hr/>
                        <div class="row">
                                <div class="col">
                                        <div class="form-group">
                                            <label for="extraData">Place extra XML data here.</label>
                                            <textarea class="form-control" id="extraData" name="extraData" rows="4">&lt;a_node&gt;some_value&lt;/a_node&gt;</textarea>
                                        </div>
                                        <button name="submitForm" id="submitForm" type="submit" class="btn btn-primary">Create Document</button>
                                </div>
                        </div>
                </form>


                <footer class="pt-4 my-md-5 pt-md-5 border-top">
                    <p class="mt-5 mb-3 text-muted text-center"><img src="img/sig-color-wbg.gif" width="128" alt="Oracle Logo" >&copy; 2018 v0.2</p>
                </footer>

    </div>

    <script src="js/jquery-3.3.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-3.3.1.min.js"><\/script>')</script>
    <script src="js/popper.min.js"></script>
    <script src="bootstrap-4.1.3-dist/js/bootstrap.min.js"></script>
    <script src="bootstrap-datepicker-1.6.4-dist/js/bootstrap-datepicker.min.js"></script>
    <script>
            $(document).ready(function() {

                        $('#effectiveDate').datepicker({
                                todayHighlight: true,
                                format: 'mm/dd/yyyy'
                        });

                        $('input[name=mainFormOption]').change(function(){
                            if (this.value == 'sbc' ){
                                    $('#benefitPlan').removeAttr('disabled',false);
                            }else{
                                    $('#benefitPlan').attr('disabled',true);
                            }
                             	if (this.value == 'medical'){
                                        $('#transplantScheduleCheck').removeAttr('disabled',false);
                                        $('#pharmacyScheduleCheck').removeAttr('disabled',false);
                                        $('#oopExpenseCheck').removeAttr('disabled',false);
                                        $('#transplantProvisionCheck').removeAttr('disabled',false);
                                        $('#pharmacyProvisionCheck').removeAttr('disabled',false);
                                }else{
                                      	$('#transplantScheduleCheck').attr('disabled',true);
                                        $('#pharmacyScheduleCheck').attr('disabled',true);
                                        $('#oopExpenseCheck').attr('disabled',true);
                                        $('#transplantProvisionCheck').attr('disabled',true);
                                        $('#pharmacyProvisionCheck').attr('disabled',true);
                                }
                        });

                        $('#documentForm').submit(function ( event ){
                                $('#submitForm').html('Submitting...');
                                $('#submitForm').attr('disabled',true);
                                
                                event.preventDefault();
                                console.log('Validating form...');

                                if (typeof $("input[name=mainFormOption]:checked").val() == 'undefined'){
                                        alert('You need to select a form');
                                        return;
                                }
                                if ($("#customerNumber").val()==''){
                                        alert('Customer number is required.');
                                        $("#customerNumber").focus();
                                        return;
                                }

                                if ($("#effectiveDate").val()==''){
                                        alert('Effective date is required.');
                                        $("#effectiveDate").focus();
                                        return;

                                }
                                if ((typeof $('#benefitPlan').attr('disabled') == 'undefined') &&
                                        ($('#benefitPlan').val()=='')) {
                                        alert('Benefit plan is required.');
                                        $("#benefitPlan").focus();
                                        return;
                                }
                                $.ajax({
                                    url: 'formprocessor',
                                    type: 'post',
                                    dataType: 'text json',
                                    data: $('#documentForm').serialize()
                                })
                                .done(function(json){
                                    $('#submitForm').html('Create Document');
                                    $('#submitForm').removeAttr('disabled',false);
                                   console.log('Response from formprocessor:'+json);
                                   if (json.success == 'true') {
      	       	       	              if (json.trnstatus == '290') {
                                       console.log('Document ready for user editing in interactive at '	+ json.url +'\nroutedesc='+json.routedesc);
                                       window.open(json.url,'_blank');
                                     }else if (json.trnstatus.endsWith('41')) {
                                    	  alert('Your document was submitted, but generated an error. Please contact your system administrator.');
                                     }else{
                                    	  alert('Your document was submitted.');
                                     }
                                  }else{
                                      alert('There was a problem processing your submission:\n'+json.message+'\nPlease contact your system administrator.');
                                  }
                                })
                                .fail(function(xhr,status,errorThrown){
                                    alert( "Sorry, there was a problem!" );
                                    console.log( "Error: " + errorThrown +"\nStatus:" + status);
                                    console.dir( xhr );
                                });

                        });


                });
            </script>
  </body>
</html>

